---
title: "Penguin Size Comparisons"
author: "Anastasia Kunz"
date: "11/9/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(palmerpenguins)
library(effsize)
library(broom)
library(ggbeeswarm)
library(car)
```


# Part 1. T-tests

Mass comparison between male and female chinstrap penguins

```{r}
chinstrap <- penguins %>% 
  filter(species == "Chinstrap")

# Histograms

ggplot(chinstrap, aes(x = body_mass_g))+
  geom_histogram(bins = 10)+
  facet_wrap(~sex)
#  somewhat normal/ bell shaped mean should be okay. male means seem a bit larger than female means.

# Quantile- Quantile

ggplot(chinstrap, aes(sample = body_mass_g))+
  geom_qq() +
  facet_wrap(~sex)

# Descriptive Stats

chinstrap %>% 
  group_by(sex) %>% 
  summarize(
    mean_mass = mean(body_mass_g),
    median_mass = median(body_mass_g),
    sd_mass = sd(body_mass_g),
    sample_size = n()
  )

```


# T test

Get vectors of body mass for female and male chinstraps separatley.

```{r}
chinstrap_f <- chinstrap %>% 
  filter(sex == "female") %>% 
  pull(body_mass_g)

chinstrap_m <- chinstrap %>% 
  filter(sex == "male") %>% 
  pull(body_mass_g)
```

Now, can run t-test:

1. Is there a significant difference in body mass between male and female chinstrap penguins?
--> not are males bigger!

```{r}
chinstrap_ttest <- t.test(chinstrap_f, chinstrap_m)
chinstrap_ttest

# effect size in effsize

cohen.d(chinstrap_f, chinstrap_m)
```

Are male chinstrap penguins significantly larger in body mass than female chinstraps?
--> one sided

```{r}
t.test(chinstrap_m, chinstrap_f, alternative = "greater")
# must be lined up; this says are males greater than female? instead of the other way around
```









